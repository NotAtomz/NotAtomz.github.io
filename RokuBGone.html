<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IR Signal to Audio</title>
</head>
<body>
    <button onclick="playIRSignal()">Play IR Signal</button>

    <script>
        function playIRSignal() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();

            function playBeep(frequency, duration) {
                return new Promise((resolve) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.type = 'square';
                    oscillator.frequency.value = frequency;
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.start();
                    gainNode.gain.setValueAtTime(1, audioContext.currentTime); // Start the beep
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime + duration / 1000); // Stop the beep after 'duration' milliseconds

                    oscillator.stop(audioContext.currentTime + duration / 1000); // Stop the oscillator

                    // Resolve the promise when the beep is done
                    oscillator.onended = resolve;
                });
            }

            async function playIRSequence() {
                // Define the IR signal timing in milliseconds
                const headerPulse = 9047; // header-pulse
                const headerSpace = 4470; // header-space
                const onePulse = 556;     // one-pulse
                const oneSpace = 1653;    // one-space
                const zeroPulse = 556;    // zero-pulse
                const zeroSpace = 527;    // zero-space
                const gapPulse = 559;     // gap-pulse

                // Play the sequence of signal pulses and spaces
                await playBeep(4000, headerPulse); // Header pulse
                await playBeep(0, headerSpace);    // Header space

                await playBeep(4000, onePulse);    // One pulse
                await playBeep(0, oneSpace);       // One space

                await playBeep(4000, zeroPulse);   // Zero pulse
                await playBeep(0, zeroSpace);      // Zero space

                await playBeep(4000, gapPulse);    // Gap pulse
            }

            playIRSequence();
        }
    </script>
</body>
</html>
