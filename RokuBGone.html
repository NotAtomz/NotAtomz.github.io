<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IR Signal to Audio</title>
</head>
<body>
    <button onclick="playIRSignal()">Play IR Signal</button>

    <script>
        function playIRSignal() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();

            function playBeep(frequency, duration) {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.type = 'square';
                oscillator.frequency.value = frequency;
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                // Start the beep
                oscillator.start(audioContext.currentTime);
                gainNode.gain.setValueAtTime(1, audioContext.currentTime);

                // Stop the beep after the duration
                gainNode.gain.setValueAtTime(0, audioContext.currentTime + duration / 1000);
                oscillator.stop(audioContext.currentTime + duration / 1000);
            }

            // Define the IR signal timing in milliseconds
            const headerPulse = 9.047; // header-pulse in ms
            const headerSpace = 4.470; // header-space in ms
            const onePulse = 0.556;     // one-pulse in ms
            const oneSpace = 1.653;    // one-space in ms
            const zeroPulse = 0.556;    // zero-pulse in ms
            const zeroSpace = 0.527;    // zero-space in ms
            const gapPulse = 0.559;     // gap-pulse in ms

            // Sequence of signal (timed beeps and silences)
            setTimeout(() => playBeep(4000, headerPulse), 0);                        // Header pulse
            setTimeout(() => playBeep(0, headerSpace), headerPulse * 1000);          // Header space

            setTimeout(() => playBeep(4000, onePulse), (headerPulse + headerSpace) * 1000);      // One pulse
            setTimeout(() => playBeep(0, oneSpace), (headerPulse + headerSpace + onePulse) * 1000); // One space

            setTimeout(() => playBeep(4000, zeroPulse), (headerPulse + headerSpace + onePulse + oneSpace) * 1000); // Zero pulse
            setTimeout(() => playBeep(0, zeroSpace), (headerPulse + headerSpace + onePulse + oneSpace + zeroPulse) * 1000); // Zero space

            setTimeout(() => playBeep(4000, gapPulse), (headerPulse + headerSpace + onePulse + oneSpace + zeroPulse + zeroSpace) * 1000); // Gap pulse
        }
    </script>
</body>
</html>
