<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IR Signal to Audio</title>
</head>
<body>
    <button onclick="playIRSignal()">Play IR Signal</button>

    <script>
        function playIRSignal() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();

            function playBeep(frequency, duration, volume) {
                return new Promise((resolve) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.type = 'square'; // Sharp beep
                    oscillator.frequency.value = frequency;
                    gainNode.gain.value = volume;

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.start();
                    gainNode.gain.setValueAtTime(volume, audioContext.currentTime);

                    setTimeout(() => {
                        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                        oscillator.stop();
                        resolve();
                    }, duration);
                });
            }

            async function playIRSequence() {
                const headerPulse = 9.047; // header-pulse in ms
                const headerSpace = 4.470; // header-space in ms
                const onePulse = 0.556;    // one-pulse in ms
                const oneSpace = 1.653;    // one-space in ms
                const zeroPulse = 0.556;   // zero-pulse in ms
                const zeroSpace = 0.527;   // zero-space in ms
                const gapPulse = 0.559;    // gap-pulse in ms

                // Play sequence with varying volumes
                await playBeep(4000, headerPulse * 20, 1.0);  // First beep, full volume
                await playBeep(0, headerSpace * 20, 0);       // Silence
                await playBeep(4000, onePulse * 20, 0.7);     // Second beep, slightly quieter
                await playBeep(0, oneSpace * 20, 0);          // Silence
                await playBeep(4000, zeroPulse * 20, 1.0);    // Third beep, full volume
                await playBeep(0, zeroSpace * 20, 0);         // Silence
                await playBeep(4000, gapPulse * 20, 0.5);     // Fourth beep, even quieter
            }

            playIRSequence();
        }
    </script>
</body>
</html>
